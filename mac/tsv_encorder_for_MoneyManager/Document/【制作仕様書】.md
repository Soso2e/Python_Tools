# TSVエンコーダー
#### 概要
PayPayから出力した履歴のデータを`らくな家計簿`にインポートするためのものに変更する。

### 動作フロー
1. .command or .bat 実行
2. Pythonアプリが立ち上がり、UIが表示される
3. UI上で行える動作：
    - **変換元ファイルを指定**
        - ファイル選択ダイアログ
        - **ドラッグ＆ドロップ**（ウィンドウにCSVを投げる）
    - **プリセットを選択**（yamlファイル。辞書登録や処理方法など。）
	- 選択したプリセットで「検証」ボタン
		- 登録されている辞書に当てはまらないもの（J列からの穴埋めの際）を探すスクリプトが実行。
		- 辞書に当てはまらないものを洗い出し、新たに登録するPopUpが出る。
    - 不備がなさそうなら、「TSV変換」ボタン
4. 内部で変換処理
5. TSV（or何らかの出力）を生成
6. ログビューアにエラーだけ表示

### 処理フロー
1. UI起動（Python）
2. .csv（元データ）を取得
3. 処理プリセットを取得
	- yamlファイル
	- 処理内容を記載（スクリプトはPythonファイル内）
	- 辞書形式で、どのお店がどれに対応するか記載
		- PASMO：交通費
		- マクドナルド：外食
		- セブンイレブン：コンビニ
		などなど
4. 処理を実行
	1. 行を削除する
			 1. H列に”獲得”の文字が入ってるものは、その行ごと削除し詰める
	2. 列を整える
		1. 削除、整理
			1. インポートした`.csv`の、**E,F,G,K,L,M**列を削除
		2. A列はそのまま。
		3. B, C, D列は合体。都度G列に支出か収入か記載。
			- インポートする`.csv`には、B,C,Dのどこかに数字が入っている
			- B, Dに数字がある場合は、G列に支出と記載
			- C列に数字がある場合は、G列に収入と記載
			- 数字のみをB列にまとめる
			- B列をF列に移動
			- I列をE列に移動
	3. 穴埋めする。
		1. J列を参考に、B列を穴埋めする。
			- PayPay、カードのどちらか。
			- カードと入っていたらカード。
		2. E列を参考に、yamlの辞書を元に、対応した文字でC列を穴埋めする。
			- コンビニの名前 → コンビニ
			- 百均など → 生活用品
			- 食事などのフードサービスの名前 → 外食
			など。
5. 変換が終わったファイルを、変換元ファイルと同じディレクトリに、名前に_yy-mm-dd-hh-mmを追加し保存
```
※ この、辞書になるyamlの登録（制作）も自動で行うことができたらいいと思っている。
実行する前に、辞書にある通りで処理が可能かどうかチェックする処理が入る。
辞書にないものがヒットした場合、ポップアップウィンドウが出て、yamlの特定の場所に新しく辞書として作成していく。
E列にあるワードをデフォで入力されている状態で出現し、編集。（辞書として登録する言葉）した後、何とマッピングするか（セレクトボックスで選択する。）
```